<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- meta info + OG tags -->
    <title>Dodajanje kontaktov na novičnik</title>
    <meta name="author" content="Danes je nov dan, Inštitut za druga vprašanja">
    <link rel="shortcut icon" href="https://danesjenovdan.si/favicon.ico">
    <!-- <meta property="og:image" content="TODO" /> -->

    <!-- Bootstrap -->
    <link href="https://podpri.djnd.si/static/css/bootstrap.min.css" rel="stylesheet">

    <!-- font -->
    <link href='https://fonts.googleapis.com/css?family=Titillium+Web:200,300,400,600,700&subset=latin-ext,latin'
        rel='stylesheet' type='text/css'>

    <!-- icons -->
    <link href="https://podpri.djnd.si/static/icons_/icons.css" rel="stylesheet">

    <!-- CSS -->
    <style>
        h1 {
            margin-top: 60px;
            margin-bottom: 40px;
        }

        .row {
            display: flex;
            justify-content: center;
        }

        label {
            display: block;
            font-size: 16px;
            margin-bottom: 10px;
        }

        input[type="email"] {
            font-size: 16px;
            margin-bottom: 15px;
        }

        input[type="submit"] {
            font-size: 16px;
            margin-bottom: 40px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-lg-6 col-xl-4">
                <h1>{{ newsletter.title }}</h1>
                <form action={% url 'add-segment-contacts' newsletter.slug %} method="post">
                    {% csrf_token %}
                    <label for="id_email">Elektronski naslov:</label>
                    {{ form.email }}
                    <!-- <input type="email" name="email" class="form-control" required="" id="id_email"> -->
                    <input type="submit" class="btn" value="Potrdi">
                    {% if form.email.errors %}
                    <p class="alert alert-danger">{{ form.email.errors }}</p>
                    {% endif %}
                    {% if error %}
                    <p class="alert alert-danger">{{ error }}</p>
                    {% endif %}
                    {% if success %}
                    <p class="alert alert-success">Shranjeno.</p>
                    {% endif %}
                </form>
            </div>
        </div>
    </div>

    <script>
        // (function () {
        //     var newsletterElems = document.querySelectorAll(".newsletter");
        //     newsletterElems.forEach(function (newsletterElem) {
        //         var form = newsletterElem.querySelector("form");
        //         var emailElem = form.querySelector("#email-newsletter");
        //         var submitButton = form.querySelector("button[type='submit']");
        //         var checkbox = form.querySelector("#confirm-email");
        //         var response = form.querySelector("#response");
        //         form.addEventListener("submit", (event) => {
        //             event.preventDefault();
        //             if (checkbox.checked) {
        //                 form.classList.remove("error");
        //                 submitButton.setAttribute("disabled", "disabled");
        //                 emailElem.setAttribute("disabled", "disabled");
        //                 checkbox.setAttribute("disabled", "disabled");
        //                 fetch('https://podpri.lb.djnd.si/api/subscribe/', {
        //                     method: 'POST',
        //                     headers: {
        //                         'Content-Type': 'application/json',
        //                     },
        //                     body: JSON.stringify({
        //                         email: emailElem.value,
        //                         segment_id: 18,
        //                     }),
        //                 })
        //                     .then((res) => {
        //                         if (res.ok) {
        //                             return res.text();
        //                         }
        //                         throw new Error('Response not ok');
        //                     })
        //                     .then((res) => {
        //                         response.className = 'form-text text-start';
        //                         response.textContent = 'Hvala za prijavo!';
        //                     })
        //                     .catch((error) => {
        //                         response.className = 'form-text text-start text-error';
        //                         response.textContent = 'Napaka pri prijavi :(';
        //                     })
        //                     .then(() => {
        //                         submitButton.removeAttribute('disabled');
        //                         emailElem.removeAttribute('disabled');
        //                         checkbox.removeAttribute('disabled');
        //                     });
        //             } else {
        //                 form.classList.add("error");
        //             }
        //         });
        //     });
        // })();

    </script>

</body>

</html>